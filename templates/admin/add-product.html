{% block content %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0"
    />
    <link rel="stylesheet" href="../../styles/styles.css" />
    <link
      rel="stylesheet"
      href="{{url_for('static', filename='stylesheet/admin.css')}}"
    />
  </head>
  <body>
    <div class="App">
      <div class="sidebar-container">
        <div class="top-nav-content">
        <i class=" burger material-symbols-outlined"> list </i>
        <div class="logo">
          <a href="index.html">
            <img src="../../img/default.png" alt="" />
          </a>
        </div>
      </div>
        <menu>
          <ul>
            <li>
              <a href="/admin">
                <i class="material-symbols-outlined"> home_app_logo </i>
                <h4>Dashboard</h4>
              </a>
            </li>
            <li>
              <a href="orders">
                <i class="material-symbols-outlined"> shopping_cart </i>
                <h4>Orders</h4>
              </a>
            </li>
            <li>
              <a href="products" class="active">
                <i class="material-symbols-outlined"> styler </i>
                <h4>Products</h4>
              </a>
            </li>
            <li>
              <a href="users">
                <i class="material-symbols-outlined"> group </i>
                <h4>Users</h4>
              </a>
            </li>
          </ul>
          <ul>
            <!-- power_settings_new -->
            <li>
              <a href="settings">
                <i class="material-symbols-outlined"> settings </i>
                <h4>Settings</h4>
              </a>
            </li>
            <li>
              <a href="">
                <i class="material-symbols-outlined"> power_settings_new </i>
                <h4>Logout</h4>
              </a>
            </li>
          </ul>
        </menu>
      </div>
      <div class="container">
        <div class="top-bar">
          <div class="welcome-text"><span>Products</span></div>
        </div>
        <div class="content">
          <div
            class="alert alert-dismissible fade show w-100 mb-1"
            role="alert"
            id="info_box"
          >
            <strong> </strong> <span></span>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="alert"
              aria-label="Close"
            ></button>
          </div>
          <form id="form" class="upload-product-form">
            <div class="input-fields">
              <h4>Upload product</h4>

              <div class="form-content">
                <label for="">Name</label>
                <input type="text" id="name" />
                <p class="form-error" id="name_err" >Input field is empty</p>
              </div>
              <div class="form-content">
                <label for="">Quantity</label>
                <input type="number" id="qty" />
                 <p class="form-error" id="qty_err" >Input field is empty</p>
              </div>
              <div class="form-content">
                <label for="">Category</label>
                <select name="" id="cat">
                  {% for cat in categories %}
                  <option value="{{cat.name}}" name="{{cat.name}}">{{cat.name}}</option>
                    {% endfor %}
                </select>
                 <p class="form-error" id="cat_err" >Input field is empty</p>
              </div>
              <div class="form-content">
                <label for="">Gender</label>
                <select name="" id="gender">
                  <option value="Men">Men</option>
                  <option value="Women">Women</option>
                </select>
                 <p class="form-error" id="gen_err" >Input field is empty</p>
              </div>
              <div class="form-content">
                <label for="">Price</label>
                <input type="number" id="price" />
                 <p class="form-error" id="price_err" >Input field is empty</p>
              </div>
              <div class="form-content">
                <label for="">Description</label>
                <textarea name="" id="desc" cols="30" rows="10"></textarea>
                 <p class="form-error" id="desc_err" >Input field is empty</p>
              </div>
              <div class="form-content"><button>Upload</button></div>
            </div>
            <div class="upload-img-container">
              <img src="" alt="" />
              <input type="file" id="img" />
              <div class="upload-img-info">
                <i class="material-symbols-outlined"> ads_click </i>
                <p>Click to upload photo</p>
              </div>
            </div>
          </form>
          <div></div>
        </div>
      </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
    <script>
         function validate() {
                let state = true
                if ($("#name").val() == "") {
                  $("#name_err").text('Please enter a Product Name')
                  $("#name_err").show()
                  state=false
                }
                if ($("#cat").val()=="") {
                  $("#cat_err").text('Please Choose a Category')
                  $("#cat_err").show()
                  state=false
                }
                if ($("#gender").val()=="") {
                  $("#gen_err").text('Please Choose a Category')
                  $("#gen_err").show()
                  state=false
                }
                 if ($("#desc").val() == "") {
                  $("#desc_err").text('Please enter a Description')
                  $("#desc_err").show()
                  state=false
                }
                 if ($("#price").val() == "") {
                  $("#price_err").text('Please enter a price name')
                  $("#price_err").show()
                  state=false
                }
                 if ($("#qty").val() == "") {
                  $("#qty_err").text('Please enter quantity')
                  $("#qty_err").show()
                  state=false
                }
                return state
            }
            
            function hideAll(){
             $("#name_err").hide()
              $("#cat_err").hide()
               $("#desc_err").hide()
                $("#qty_err").hide()
                 $("#price_err").hide()
                 $("#gen_err").hide()
            }


     
      $(document).ready(() => {
        hideAll()
        $("#info_box").hide();
        $("#info_box").removeClass("alert-danger");
        $("#info_box").removeClass("alert-success")
     $('input').on( 'keypress',(e) => {
                let input = e.currentTarget
                $("#"+input.getAttribute("id")).removeClass("error")
                $("#"+input.getAttribute("id")+"_error").text('')
                hideAll ()
            })
        $("#form").submit((e) => {
          e.preventDefault();
          if (validate()) {
             let data = {
            name: $("#name").val(),
            category: $("#cat").val(),
            gender: $("#gender").val(),
            qty: $("#qty").val(),
            price: $("#price").val(),
            description: $("#desc").val(),
            image: $("#img").prop("files")[0],
            
          };
          
          let formData = new FormData();
          for (var key in data) {
            console.log(key);
            console.log(data[key]);
            formData.append(key, data[key]);
          }
          console.log(formData.get('category'));

          $.ajax({
            type: "POST",
            url: "/product/add",
            data: formData,
            processData: false,
            contentType: false,
          })
            .done((res) => {
              if (res.status === "success") {
                alert("success")
              } else {
                $("#info_box").show();
                $("#info_box").addClass("alert-danger");
                $("#info_box > strong").text("Error");
                $("#info_box > span").text(res.message);
              }
            })
            .fail((e) => console.log(e));
          }
         
        });
      });
    </script>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
      crossorigin="anonymous"
    ></script>
    <script>
      const burger = document.querySelector(".burger");
      const sideBar = document.querySelector(".sidebar-container");
      const body = document.querySelector("body");
      console.log(burger);
      burger.addEventListener("click",()=>{
        sideBar.classList.toggle("showBar")
        if(sideBar.classList.contains("showBar")) body.style.overflow ="hidden";
        else  body.style.overflow ="visible";
      })
    </script>
  </body>
</html>
{% endblock %}